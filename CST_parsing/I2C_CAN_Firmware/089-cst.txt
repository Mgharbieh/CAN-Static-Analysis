I2C_CAN_Firmware-I2C_CAN_dfs.h

|Node:translation_unit
|—Node:preproc_ifdef Text: #ifndef __I2C_CAN_DFS_H__
#define __I2C_CAN_DFS_H__

#include <avr/io.h>

// watch dog
#define WD_SET(val,...)                                 \
    __asm__ __volatile__(                               \
        "in __tmp_reg__,__SREG__"           "\n\t"      \
        "cli"                               "\n\t"      \
        "wdr"                               "\n\t"      \
        "sts %[wdreg],%[wden]"              "\n\t"      \
        "sts %[wdreg],%[wdval]"             "\n\t"      \
        "out __SREG__,__tmp_reg__"          "\n\t"      \
        :                                               \
        : [wdreg] "M" (&WDTCSR),                        \
          [wden]  "r" ((uint8_t)(0x18)),                \
          [wdval] "r" ((uint8_t)(val|(__VA_ARGS__+0)))  \
        : "r0"                                          \
)

#define WDTO_15MS               0
#define WDTO_30MS               1
#define WDTO_60MS               2
#define WDTO_120MS              3
#define WDTO_250MS              4
#define WDTO_500MS              5
#define WDTO_1S                 6
#define WDTO_2S                 7
#define WDTO_4S                 0x20
#define WDTO_8S                 0x21

#define WD_RST                  8
#define WDR()                   __asm__ __volatile__("wdr")

#define DEFAULT_I2C_ADDR    0X25

#define REG_ADDR        0X01
#define REG_DNUM        0x02
#define REG_BAUD        0X03
#define REG_MASK0       0X60
#define REG_MASK1       0X65
#define REG_FILT0       0X70
#define REG_FILT1       0X80
#define REG_FILT2       0X90
#define REG_FILT3       0XA0
#define REG_FILT4       0XB0
#define REG_FILT5       0XC0

#define REG_SEND        0X30
#define REG_RECV        0X40

#define REG_ADDR_SET    0X51

#endif
|——Node:#ifndef Text: #ifndef
|——Node:identifier Text: __I2C_CAN_DFS_H__
|——Node:preproc_def Text: #define __I2C_CAN_DFS_H__

|———Node:#define Text: #define
|———Node:identifier Text: __I2C_CAN_DFS_H__
|——Node:preproc_include Text: #include <avr/io.h>

|———Node:#include Text: #include
|———Node:system_lib_string Text: <avr/io.h>
|——Node:comment
|——Node:preproc_function_def Text: #define WD_SET(val,...)                                 \
    __asm__ __volatile__(                               \
        "in __tmp_reg__,__SREG__"           "\n\t"      \
        "cli"                               "\n\t"      \
        "wdr"                               "\n\t"      \
        "sts %[wdreg],%[wden]"              "\n\t"      \
        "sts %[wdreg],%[wdval]"             "\n\t"      \
        "out __SREG__,__tmp_reg__"          "\n\t"      \
        :                                               \
        : [wdreg] "M" (&WDTCSR),                        \
          [wden]  "r" ((uint8_t)(0x18)),                \
          [wdval] "r" ((uint8_t)(val|(__VA_ARGS__+0)))  \
        : "r0"                                          \
)

|———Node:#define Text: #define
|———Node:identifier Text: WD_SET
|———Node:preproc_params Text: (val,...)
|————Node:( Text: (
|————Node:identifier Text: val
|————Node:, Text: ,
|————Node:... Text: ...
|————Node:) Text: )
|———Node:preproc_arg Text: __asm__ __volatile__(                               \
        "in __tmp_reg__,__SREG__"           "\n\t"      \
        "cli"                               "\n\t"      \
        "wdr"                               "\n\t"      \
        "sts %[wdreg],%[wden]"              "\n\t"      \
        "sts %[wdreg],%[wdval]"             "\n\t"      \
        "out __SREG__,__tmp_reg__"          "\n\t"      \
        :                                               \
        : [wdreg] "M" (&WDTCSR),                        \
          [wden]  "r" ((uint8_t)(0x18)),                \
          [wdval] "r" ((uint8_t)(val|(__VA_ARGS__+0)))  \
        : "r0"                                          \
)
|——Node:preproc_def Text: #define WDTO_15MS               0

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_15MS
|———Node:preproc_arg Text: 0
|——Node:preproc_def Text: #define WDTO_30MS               1

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_30MS
|———Node:preproc_arg Text: 1
|——Node:preproc_def Text: #define WDTO_60MS               2

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_60MS
|———Node:preproc_arg Text: 2
|——Node:preproc_def Text: #define WDTO_120MS              3

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_120MS
|———Node:preproc_arg Text: 3
|——Node:preproc_def Text: #define WDTO_250MS              4

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_250MS
|———Node:preproc_arg Text: 4
|——Node:preproc_def Text: #define WDTO_500MS              5

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_500MS
|———Node:preproc_arg Text: 5
|——Node:preproc_def Text: #define WDTO_1S                 6

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_1S
|———Node:preproc_arg Text: 6
|——Node:preproc_def Text: #define WDTO_2S                 7

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_2S
|———Node:preproc_arg Text: 7
|——Node:preproc_def Text: #define WDTO_4S                 0x20

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_4S
|———Node:preproc_arg Text: 0x20
|——Node:preproc_def Text: #define WDTO_8S                 0x21

|———Node:#define Text: #define
|———Node:identifier Text: WDTO_8S
|———Node:preproc_arg Text: 0x21
|——Node:preproc_def Text: #define WD_RST                  8

|———Node:#define Text: #define
|———Node:identifier Text: WD_RST
|———Node:preproc_arg Text: 8
|——Node:preproc_function_def Text: #define WDR()                   __asm__ __volatile__("wdr")

|———Node:#define Text: #define
|———Node:identifier Text: WDR
|———Node:preproc_params Text: ()
|————Node:( Text: (
|————Node:) Text: )
|———Node:preproc_arg Text: __asm__ __volatile__("wdr")
|——Node:preproc_def Text: #define DEFAULT_I2C_ADDR    0X25

|———Node:#define Text: #define
|———Node:identifier Text: DEFAULT_I2C_ADDR
|———Node:preproc_arg Text: 0X25
|——Node:preproc_def Text: #define REG_ADDR        0X01

|———Node:#define Text: #define
|———Node:identifier Text: REG_ADDR
|———Node:preproc_arg Text: 0X01
|——Node:preproc_def Text: #define REG_DNUM        0x02

|———Node:#define Text: #define
|———Node:identifier Text: REG_DNUM
|———Node:preproc_arg Text: 0x02
|——Node:preproc_def Text: #define REG_BAUD        0X03

|———Node:#define Text: #define
|———Node:identifier Text: REG_BAUD
|———Node:preproc_arg Text: 0X03
|——Node:preproc_def Text: #define REG_MASK0       0X60

|———Node:#define Text: #define
|———Node:identifier Text: REG_MASK0
|———Node:preproc_arg Text: 0X60
|——Node:preproc_def Text: #define REG_MASK1       0X65

|———Node:#define Text: #define
|———Node:identifier Text: REG_MASK1
|———Node:preproc_arg Text: 0X65
|——Node:preproc_def Text: #define REG_FILT0       0X70

|———Node:#define Text: #define
|———Node:identifier Text: REG_FILT0
|———Node:preproc_arg Text: 0X70
|——Node:preproc_def Text: #define REG_FILT1       0X80

|———Node:#define Text: #define
|———Node:identifier Text: REG_FILT1
|———Node:preproc_arg Text: 0X80
|——Node:preproc_def Text: #define REG_FILT2       0X90

|———Node:#define Text: #define
|———Node:identifier Text: REG_FILT2
|———Node:preproc_arg Text: 0X90
|——Node:preproc_def Text: #define REG_FILT3       0XA0

|———Node:#define Text: #define
|———Node:identifier Text: REG_FILT3
|———Node:preproc_arg Text: 0XA0
|——Node:preproc_def Text: #define REG_FILT4       0XB0

|———Node:#define Text: #define
|———Node:identifier Text: REG_FILT4
|———Node:preproc_arg Text: 0XB0
|——Node:preproc_def Text: #define REG_FILT5       0XC0

|———Node:#define Text: #define
|———Node:identifier Text: REG_FILT5
|———Node:preproc_arg Text: 0XC0
|——Node:preproc_def Text: #define REG_SEND        0X30

|———Node:#define Text: #define
|———Node:identifier Text: REG_SEND
|———Node:preproc_arg Text: 0X30
|——Node:preproc_def Text: #define REG_RECV        0X40

|———Node:#define Text: #define
|———Node:identifier Text: REG_RECV
|———Node:preproc_arg Text: 0X40
|——Node:preproc_def Text: #define REG_ADDR_SET    0X51

|———Node:#define Text: #define
|———Node:identifier Text: REG_ADDR_SET
|———Node:preproc_arg Text: 0X51
|——Node:#endif Text: #endif
|—Node:comment
